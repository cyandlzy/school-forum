<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>校园论坛</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <nav id="navbar" class="navbar navbar-expand-lg navbar-dark hidden">
        <div class="container">
            <a class="navbar-brand" href="#" onclick="showSection('home')">校园论坛</a>
            <div class="navbar-nav">
                <a class="nav-link" href="#" onclick="showSection('home')">首页</a>
                <a class="nav-link" href="#" onclick="showSection('posts')">论坛</a>
                <a class="nav-link" href="#" onclick="showSection('profile')">个人中心</a>
                <a class="nav-link" href="#" onclick="logout()">退出</a>
            </div>
        </div>
    </nav>

    <div class="container mt-4">
        <!-- 登录/注册 -->
        <div id="auth" class="card p-4 visible">
            <h4 class="text-center mb-4">登录/注册</h4>
            <div class="mb-3">
                <label>用户名/邮箱</label>
                <input type="text" id="usernameEmail" class="form-control">
            </div>
            <div class="mb-3">
                <label>密码</label>
                <input type="password" id="password" class="form-control">
            </div>
            <div class="mb-3" id="confirmPasswordDiv" style="display:none;">
                <label>确认密码</label>
                <input type="password" id="confirmPassword" class="form-control">
            </div>
            <div id="errorMessage" class="text-danger mb-3"></div>
            <button class="btn btn-primary w-100 mb-2" onclick="signIn()">登录</button>
            <button class="btn btn-outline-primary w-100" onclick="toggleRegister()">注册</button>
        </div>

        <!-- 首页 -->
        <div id="home" class="hidden">
            <h4>欢迎使用校园论坛</h4>
            <div class="card mt-3">
                <div class="card-body">
                    <h5>最新帖子</h5>
                    <div id="recentPosts"></div>
                </div>
            </div>
            <div class="card mt-3">
                <div class="card-body">
                    <h5>意见反馈</h5>
                    <textarea id="feedbackContent" class="form-control mb-2" rows="3" placeholder="请输入反馈..."></textarea>
                    <button class="btn btn-primary" onclick="submitFeedback()">提交</button>
                </div>
            </div>
        </div>

        <!-- 论坛 -->
        <div id="posts" class="hidden">
            <h4>论坛</h4>
            <button class="btn btn-primary mb-3" onclick="showSection('postForm')">发帖</button>
            <div id="postsList"></div>
        </div>

        <!-- 发帖 -->
        <div id="postForm" class="hidden">
            <h4>发布帖子</h4>
            <div class="card p-3">
                <input type="text" id="postTitle" class="form-control mb-2" placeholder="标题">
                <select id="postCategory" class="form-control mb-2">
                    <option value="">选择分类</option>
                    <option value="学习">学习</option>
                    <option value="生活">生活</option>
                </select>
                <textarea id="postContent" class="form-control mb-2" rows="4" placeholder="内容"></textarea>
                <button class="btn btn-primary" onclick="submitPost()">发布</button>
            </div>
        </div>

        <!-- 个人中心 -->
        <div id="profile" class="hidden">
            <h4>个人中心</h4>
            <div class="card p-3">
                <img id="profileImg" src="https://via.placeholder.com/80" class="mb-2">
                <div>用户名: <span id="profileUsername"></span></div>
                <div>班级: <span id="profileClass"></span></div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="config.js"></script>
    <script src="script.js"></script>
</body>
</html>